#:import basename os.path.basename

WindowManager:
    MainWindow:
    RecapWindow:
    ProgressWindow:

<MainWindow>:
    name: "main"

    RelativeLayout:

        Button:
            id: open_button
            text: "Apri"
            size_hint: 0.30,0.20
            pos_hint: {'top':0.95, 'x':0.02}
            font_size: 32
            on_release: root.choose_file()

        Label:
            id: filename_label
            text: basename(app.options.get_exc_path())
            size_hint: 0.15,0.15
            pos_hint: {'top':1.02, 'x':0.465}

        Button:
            id: visualize_button
            text: "Visualizza"
            size_hint: 0.40,0.10
            pos_hint: {'top':0.90, 'x':0.34}
            font_size: 24
            disabled: not app.options.get_exc_path()
            on_release: root.preview_excel()

        Button:
            text: "Invia"
            size_hint: 0.25,0.45
            font_size: 32
            on_release: root.check_and_recap()
            pos_hint: {'top':0.52, 'x':0.74}

        TextInput:
            id: message_input
            hint_text: "Inserisci un messaggio..."

            size_hint: 0.30,0.20
            pos_hint: {'top':0.60, 'x':0.02}

        TextInput:
            id: row_input
            input_filter: 'int'
            hint_text: "Inserisci riga di partenza..."
            size_hint: 0.25,0.05
            pos_hint: {'top':0.60, 'x':0.74}

        Button:
            id: open_images
            text: "Aggiungi\nimmagine/video"
            size_hint: 0.30,0.20
            pos_hint: {'top':0.30, 'x':0.02}
            font_size: 20
            on_release: root.load_images()

        Label:
            id: image_label
            text: basename("Nessun immagine selezionata")
            size_hint: 0.30,0.30
            pos_hint: {'top':0.74, 'x':0.385}

        Image:
            id: images_holder
            size_hint: 0.30,0.30
            allow_stretch: True
            pos_hint: {'top':0.35, 'x':0.38}
            source: "place_holder_donore_come_manfredi.PNG"

        Button:
            id: next_image_button
            text: ">"
            size_hint: 0.05, 0.10
            pos_hint: {'top':0.25, 'x':0.68}
            on_release: root.next_pic()

        Button:
            id: prev_image_button
            text: "<"
            size_hint: 0.05, 0.10
            pos_hint: {'top':0.25, 'x':0.33} #0.50
            on_release: root.prev_pic()


<RecapWindow>:
    name:"recap"
    RelativeLayout:
        GridLayout:
            rows : 4
            cols : 2
            size_hint: 0.9, 0.5
            pos_hint: {'center_x':0.5, 'top':0.95}

            Label:
                text : "Testo del messaggio: "
                halign: 'left'

            Label:
            #    text: main.message_input.text

            Label:
                text : "File dei numeri: "
                halign: 'left'
            Label:


            Label:
                text : "Indice di partenza: "
                halign: 'left'

            Label:

            Label:
                text : "Immagini selezionate: "
                halign: 'left'
            Label:

        Button:
            text:"Conferma e invia"
            size_hint: 0.20,0.07
            pos_hint:{'y': 0.10, 'right': 0.75}
        Button:
            text:"Indietro"
            size_hint: 0.20,0.07
            pos_hint:{'y': 0.10, 'x': 0.25}
            on_release:
                root.manager.transition.direction = 'right'
                root.manager.current = 'main'



<ProgressWindow>:
    name:"progress"

<Alert>:
    name:"alert"
    size: 500, 250
    size_hint: None, None
    RelativeLayout:
        Label:
            id: alert_message
            text_size: self.width, None
            size_hint: 0.9, 0.7
            height: self.texture_size[1]
            pos_hint:{'center_x':0.5, 'top':0.95}
            halign: 'auto'
            valign: 'middle'
            max_lines: 6

        Button:
            text: "Chiudi"
            pos_hint:{'y': 0.10, 'right': 0.95}
            size_hint : (0.3,0.2)
            on_release: root.dismiss()
